<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Written in the Stars</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* --- CORE VARIABLES --- */
        :root {
            --primary: #ff4d6d;
            --accent: #ffb3c1;
            --dark: #0f172a;
            --gold: #ffd700;
        }

        /* --- RESET & LAYOUT --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            height: 100vh; /* Fallback */
            height: 100dvh; /* Mobile viewport fix */
            width: 100vw;
            overflow: hidden;
            background-color: var(--dark);
            color: white;
            font-family: 'Poppins', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        /* --- BACKGROUND CANVAS --- */
        #star-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        /* --- MAIN CARD --- */
        .card {
            position: relative;
            z-index: 10;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: clamp(1.5rem, 5vw, 3rem); /* Responsive Padding */
            border-radius: 20px;
            text-align: center;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.6s;
        }

        /* Responsive Typography using clamp */
        h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2rem, 8vw, 3.5rem); 
            background: linear-gradient(to right, #ff9a9e, #fecfef, #feada6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
            line-height: 1.1;
        }

        p.subtitle {
            font-size: clamp(0.9rem, 4vw, 1.1rem);
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 2rem;
            font-weight: 300;
            line-height: 1.5;
        }

        /* --- BUTTONS --- */
        .actions {
            display: flex;
            flex-direction: row; /* Default row */
            justify-content: center;
            align-items: center;
            gap: 1.5rem;
            margin-top: 1rem;
            min-height: 60px; /* Reserve space */
        }

        .btn {
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            white-space: nowrap;
        }

        .btn-yes {
            background: linear-gradient(135deg, var(--primary), #c9184a);
            color: white;
            box-shadow: 0 10px 20px rgba(255, 77, 109, 0.3);
            z-index: 5;
        }
        
        .btn-yes:hover, .btn-yes:active { transform: scale(1.05); }

        .btn-no {
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: rgba(255, 255, 255, 0.7);
            z-index: 4;
            transition: 0.2s; /* Fast transition for the jump */
        }

        /* --- SUCCESS OVERLAY --- */
        #success-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 1s ease;
            padding: 20px;
            overflow-y: auto; /* Allow scrolling on small screens */
        }

        #success-container.visible {
            opacity: 1;
            pointer-events: all;
        }

        .gallery {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            width: 100%;
            max-width: 800px;
        }

        .polaroid {
            background: white;
            padding: 8px 8px 25px 8px;
            width: 150px; /* Default size */
            transform: rotate(-5deg);
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            opacity: 0; 
            transition: transform 0.3s;
        }
        
        .polaroid img { width: 100%; height: auto; display: block; filter: sepia(20%); }

        /* Mobile Adjustments for Gallery */
        @media (max-width: 600px) {
            .gallery {
                flex-direction: column;
                align-items: center;
                gap: 20px;
                margin-top: 50px; /* Space for scrolling */
            }
            .polaroid {
                width: 70%; /* Wider on mobile */
                max-width: 250px;
                transform: rotate(0deg) !important; /* Straighter on mobile */
                margin-bottom: 10px;
            }
        }

        .message-box {
            max-width: 600px;
            text-align: center;
            padding: 0 10px;
        }

        .message-box h2 {
            font-family: 'Playfair Display';
            font-size: clamp(2rem, 5vw, 3rem);
            color: var(--primary);
            margin-bottom: 15px;
        }

        .typing-text {
            font-size: clamp(1rem, 3vw, 1.2rem);
            line-height: 1.6;
            color: #ddd;
            min-height: 80px;
        }

    </style>
</head>
<body>

    <canvas id="star-canvas"></canvas>

    <div class="card" id="main-card">
        <h1>Will you be my Valentine?</h1>
        <p class="subtitle">There is only one person I want to share my universe with.</p>
        
        <div class="actions">
            <button class="btn btn-yes" id="yesBtn">YES! ❤️</button>
            <button class="btn btn-no" id="noBtn">No</button>
        </div>
    </div>

    <div id="success-container">
        <div class="gallery">
            <div class="polaroid" style="animation-delay: 0.1s">
                <img src="https://images.unsplash.com/photo-1518199266791-5375a83190b7?auto=format&fit=crop&w=400&q=80" alt="Memory 1">
            </div>
            <div class="polaroid" style="animation-delay: 0.2s">
                <img src="https://images.unsplash.com/photo-1516589178581-6cd7833ae3b2?auto=format&fit=crop&w=400&q=80" alt="Memory 2">
            </div>
            <div class="polaroid" style="animation-delay: 0.3s">
                <img src="https://images.unsplash.com/photo-1529333166437-7750a6dd5a70?auto=format&fit=crop&w=400&q=80" alt="Memory 3">
            </div>
        </div>

        <div class="message-box">
            <h2>You said Yes!</h2>
            <p class="typing-text" id="final-message"></p>
        </div>
    </div>

    <script>
        /**
         * 1. RESPONSIVE BACKGROUND ANIMATION
         */
        const canvas = document.getElementById('star-canvas');
        const ctx = canvas.getContext('2d');
        
        let width, height;

        // Handle resize nicely
        function resize() {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        }
        window.addEventListener('resize', resize);
        resize();

        let stars = [];
        const numStars = 150;

        class Star {
            constructor() {
                this.reset();
            }
            reset() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.size = Math.random() * 2;
                this.speedX = Math.random() * 0.5 - 0.25;
                this.speedY = Math.random() * 0.5 - 0.25;
                this.brightness = Math.random();
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.brightness += Math.random() * 0.05 - 0.025;
                
                if (this.brightness > 1) this.brightness = 1;
                if (this.brightness < 0) this.brightness = 0;

                if (this.x < 0 || this.x > width || this.y < 0 || this.y > height) {
                    this.reset();
                }
            }
            draw() {
                ctx.fillStyle = `rgba(255, 255, 255, ${this.brightness})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function initStars() {
            stars = [];
            for (let i = 0; i < numStars; i++) {
                stars.push(new Star());
            }
        }
        initStars();

        function animateStars() {
            ctx.clearRect(0, 0, width, height);
            stars.forEach(star => {
                star.update();
                star.draw();
            });
            requestAnimationFrame(animateStars);
        }
        animateStars();

        /**
         * 2. SMART "NO" BUTTON (Touch & Mouse Compatible)
         */
        const noBtn = document.getElementById('noBtn');
        const yesBtn = document.getElementById('yesBtn');
        const noTexts = ["No", "Sure?", "Please?", "Don't!", "Last chance!", "Heartless!", "Cry..."];
        let textIndex = 0;

        function moveNoButton(e) {
            // Prevent default touch behavior (scrolling/clicking)
            if(e && e.type === 'touchstart') e.preventDefault();

            // Get button dimensions
            const btnWidth = noBtn.offsetWidth;
            const btnHeight = noBtn.offsetHeight;

            // Safe area calculation (stay within screen with 20px padding)
            const maxWidth = window.innerWidth - btnWidth - 20;
            const maxHeight = window.innerHeight - btnHeight - 20;

            // Generate random position
            const newX = Math.max(10, Math.random() * maxWidth);
            const newY = Math.max(10, Math.random() * maxHeight);

            // Apply new position fixed to screen
            noBtn.style.position = 'fixed';
            noBtn.style.left = `${newX}px`;
            noBtn.style.top = `${newY}px`;
            
            // Change text & Grow Yes Button
            textIndex = (textIndex + 1) % noTexts.length;
            noBtn.innerText = noTexts[textIndex];
            
            // Scale up YES button slightly for encouragement
            const currentScale = parseFloat(yesBtn.getAttribute('data-scale')) || 1;
            const newScale = currentScale + 0.1;
            yesBtn.style.transform = `scale(${newScale})`;
            yesBtn.setAttribute('data-scale', newScale);
        }

        // Add both Mouse and Touch listeners
        noBtn.addEventListener('mouseover', moveNoButton); // Desktop hover
        noBtn.addEventListener('touchstart', moveNoButton, { passive: false }); // Mobile touch
        noBtn.addEventListener('click', moveNoButton); // Fallback

        /**
         * 3. THE "YES" REVEAL
         */
        const mainCard = document.getElementById('main-card');
        const successContainer = document.getElementById('success-container');
        const polaroids = document.querySelectorAll('.polaroid');

        yesBtn.addEventListener('click', () => {
            // Hide Proposal
            mainCard.style.opacity = '0';
            mainCard.style.transform = 'scale(0.8)';
            
            setTimeout(() => {
                mainCard.style.display = 'none';
                successContainer.classList.add('visible');
                
                // Animate Polaroids
                polaroids.forEach((card, index) => {
                    card.style.opacity = '1';
                    // Staggered drop-in animation
                    card.animate([
                        { transform: 'translateY(-50px)', opacity: 0 },
                        { transform: 'translateY(0)', opacity: 1 }
                    ], {
                        duration: 800,
                        delay: index * 200,
                        easing: 'ease-out',
                        fill: 'forwards'
                    });
                });

                // Type Letter
                typeMessage();
                
                // Confetti Explosion
                createHeartExplosion();

            }, 500);
        });

        // CUSTOMIZE YOUR LETTER HERE
        const message = "You've just made me the happiest person in the universe. I promise to love you, cherish you, and annoy you in the best way possible, forever.";
        const speed = 40;
        let charIndex = 0;

        function typeMessage() {
            if (charIndex < message.length) {
                document.getElementById('final-message').innerHTML += message.charAt(charIndex);
                charIndex++;
                setTimeout(typeMessage, speed);
            }
        }

        /* --- HEART EXPLOSION EFFECT --- */
        function createHeartExplosion() {
            for (let i = 0; i < 50; i++) {
                const heart = document.createElement('div');
                heart.innerHTML = '❤';
                heart.style.position = 'fixed';
                heart.style.left = '50%';
                heart.style.top = '50%';
                heart.style.fontSize = Math.random() * 20 + 10 + 'px';
                heart.style.color = '#ff4d6d';
                heart.style.zIndex = '1000';
                heart.style.pointerEvents = 'none';
                document.body.appendChild(heart);

                const angle = Math.random() * Math.PI * 2;
                const velocity = Math.random() * 200 + 50;
                
                const anim = heart.animate([
                    { transform: 'translate(-50%, -50%) scale(0)', opacity: 1 },
                    { transform: `translate(calc(-50% + ${Math.cos(angle) * velocity}px), calc(-50% + ${Math.sin(angle) * velocity}px)) scale(1)`, opacity: 0 }
                ], {
                    duration: 1000,
                    easing: 'ease-out'
                });
                
                anim.onfinish = () => heart.remove();
            }
        }
    </script>
</body>
</html>
